## DBForMySQL

| ControlId | Dependent Azure API(s) and Properties | Control spec |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_DBforMySQL_Audit_Enable_ATP<br><br><b>DisplayName:</b><br>Threat detection must be enabled for MySQL database.<br><br><b>Description: </b><br> Advanced Threat Protection must be enabled for Azure Database for MySQL. |<b> ARM API to lists all the DBForMySQL under the subscription. </b> </br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}<br>/providers/Microsoft.DBforMySQL/servers/{name}/securityAlertPolicies<br>/Default?api-version=2017-12-01 <br><br><b>Properties:</b><br> ATPStatus<br> EmailAccountAdmins<br> Tier<br> Emails<br> DisabledAlerts | <b>Scope: </b> Applies to all tiers of MySQL database except Basic pricing tier. <br><br><b>Config: </b> UnsupportedTier: Basic<br><br> <b>Passed: </b><br> a. ATP is enabled <br> *and* <br> b. Email to account admin is also enabled. <br><br> <b>Failed: </b><br> a. MySQL database is using Basic pricing tier.  <br> *or* <br> b. ATP is disabled <br> *or* <br> c. ATP is enabled but <br> 1. 'Email notifications to admins' is disabled as well as explicit email(s) are not configured. <br> 2. All 'Advanced threat protection types' are not enabled.| 