## Storage

| ControlId | Dependent Azure API(s) and Properties | Control spec |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_Storage_AuthN_Dont_Allow_Anonymous<br><br><b>DisplayName:</b><br>Ensure secure access to storage account containers.<br><br><b>Description: </b><br>The Access Type for containers must not be set to 'Anonymous'. | <b>ARM API to list Storage Account at subscription level: </b><br>/subscriptions/{subscriptionId}/providers<br>/Microsoft.Storage/storageAccounts?<br>api-version=2019-06-01 <br><br><b>Properties:</b><br>allowBlobPublicAccess, provisioningState, kind | <b>Scope: </b> It applies to all the Storage Account types except for File Storage.<br><br><b>Config: </b> StorageContainerScanLimit: 5000<br><br> <b>Passed: </b><br>Storage does not have any container with public access.<br><br> <b>Failed: </b><br>Storage has at least one container with public access or provisioning state for storage is not 'Succeeded'.<br><b>Verify: </b><br>Not able to fetch container details for storage.<br><br><b>NotApplicable: </b><br>Storage is of type FileStorage.(Kind FileStorage does not support containers). |
| <b>ControlId:</b><br>Azure_Storage_DP_Encrypt_In_Transit<br><br><b>DisplayName:</b><br>Secure transfer to storage accounts must be enabled.<br><br><b>Description: </b><br>HTTPS protocol must be used for accessing Storage Account resources. | <b>ARM API to list Storage Account at subscription level: </b><br>/subscriptions/{subscriptionId}/providers/Microsoft.Storage/storageAccounts<br>?api-version=2019-06-01 <br><br><b>Properties:</b><br>isHttpsEnabled | <b>Scope: </b> Applies to all variants of Azure Storage service.<br><br><b>Config: </b> NA<br><br> <b>Passed: </b><br>'Secure transfer required' property is enabled for the storage account.<br><br> <b>Failed: </b><br>'Secure transfer required' property is not enabled for the storage account. |
