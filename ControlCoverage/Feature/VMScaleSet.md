## Virtual Machine Scale Set

| ControlId | Dependent Azure API(s) and Properties | Control spec |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_VirtualMachineScaleSet_SI_Enable_Antimalware<br><br><b>DisplayName:</b><br>Antimalware must be enabled with real time protection on Virtual Machine Scale Set.<br><br><b>Description: </b><br> Antimalware must be enabled with real time protection on Virtual Machine Scale Set. | <b> ARM API to list VMSS deatils: </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.Compute<br>/virtualMachineScaleSets?api-version=2019-07-01<br><br><b>Properties:</b><br> osType, Publisher, Properties/autoUpgradeConfigured, Properties/realTimeProtectionEnabled | <b>Scope: </b> Applies to all Windows VMs (Linux VMSSs NA currently).<br><br><b>Config: </b> <br>ExtensionType: IaaSAntimalware<br> Publisher: Microsoft.Azure.Security<br><br> <b>Passed: </b><br>a. Extension is present in VMSS. <br> *and* <br>  b. Auto-upgrade-to-minor-version is enabled. <br> *and* <br> c. Real-time-protection is enabled. <br><br> <b>Failed: </b><br>a. AntiMalware extension not deplyed at VMSS model or at one or more VM instances. <br> *or* <br>  b. AntiMalware extension is present but Auto Upgarde to minor version is disabled. <br> *or* <br> c. AntiMalware extension is present but Auto Realtime protection is disabled. <br><br> <b>NotApplicable: </b><br>VMSS is running on Linux OS.|
