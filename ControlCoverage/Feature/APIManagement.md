## API Management

| ControlId | Dependent Azure API(s) and Properties | Control spec |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_APIManagement_AuthN_Disable_Management_API<br><br><b>DisplayName:</b><br>Do not use API Management REST API. <br><br><b>Description: </b><br> Do not use API Management REST API. | <b>ARM API to list APIMs and its related property at Subscription level: </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.ApiManagement/service?</br>api-version=2019-12-01</br><b>Properties:</b></br>sku <br><br> <b>ARM API to get tenant access information details without secrets:</b><br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ApiManagement/service/{serviceName}/tenant/access?<br> api-version=2019-12-01<br><br><b>Properties:</b><br>enabled| <b>Scope: </b> This control applies to all variants of APIM service, except Consumption tier.<br><br><b>Config: </b>NA<br><br><b>Passed: </b><br>'Enable Management REST API' option is turned OFF.<br><br><b>Failed: </b><br>'Enable Management REST API' option is turned ON.<br><br><b>Verify: </b><br> Management API setting could not be verified as the API Management service is connected to a Virtual Network. As a result, control plane traffic on port 3443 is denied. <br><br><b>NotApplicable: </b><br> This control does not apply to consumption tier.|
| <b>ControlId:</b><br>Azure_APIManagement_AuthN_Use_AAD_for_Client_AuthN<br><br><b>DisplayName:</b><br>Enterprise applications using APIM must authenticate developers/applications using Azure Active Directory backed credentials.<br><br><b>Description: </b><br> Enterprise applications using APIM must authenticate developers/applications using Azure Active Directory backed credentials. | <b> ARM API to list APIMs and its related property at Subscription level: </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.ApiManagement/service?<br>api-version=2019-12-01<br><br><b>Properties:</b><br>sku <br><br><b>ARM API to list collection of portalsettings defined within a service instance: <br> </b> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ApiManagement/service/{serviceName}/portalsettings?<br>api-version=2018-06-01-preview <br><br><b>Properties:</b><br> name: "signup" <br> properties/enabled <br><br> <b>ARM API to list collection of Identity Provider configured in the specified service instance:</b> <br> /subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.ApiManagement/service/{serviceName}/identityProviders?<br>api-version=2019-12-01 <br><br><b>Properties:</b><br>properties/type | <b>Scope: </b> This control applies to all variants of APIM service, except Consumption tier. <br><br><b>Config: </b> AllowedIdentityProvider: Aad<br><br> <b>Passed: </b><br> 1. AAD Identity provider is being used for authentication in developer portal. <br> 2. Sign-up/sign-in option has been entirely disabled. <br><br><b>Failed: </b><br>Identity provider other than AAD is being used for authentication in developer portal.<br><br><b>Verify: </b><br> Sign up option setting could not be verified as the API Management service is connected to a Virtual Network. As a result, control plane traffic on port 3443 is denied. <br><br><b>NotApplicable: </b><br> This control does not apply to consumption tier.|
| <b>ControlId:</b><br>Azure_APIManagement_DP_Use_Secure_TLS_Version<br><br><b>DisplayName:</b><br>Ensure that only the most secure and up to date version of TLS is enabled on the API gateway.<br><br><b>Description: </b><br> Ensure that only the most secure and up to date version of TLS is enabled on the API gateway. | <b>ARM API to list APIMs and its related property at Subscription level: </b> </br> /subscriptions/{subscriptionId}/providers/Microsoft.ApiManagement/service?api-version=2019-12-01 <br><br><b>Properties:</b><br> properties/customProperties <br> <b> Custom properties of the API Management service: </b> <br> 1. Microsoft.WindowsAzure.ApiManagement.Gateway.Security.Ciphers.TripleDes168 <br> 2. Microsoft.WindowsAzure.ApiManagement.Gateway.Security.Protocols.Tls10 <br>3. Microsoft.WindowsAzure.ApiManagement.Gateway.Security.Protocols.Tls11 <br>4. Microsoft.WindowsAzure.ApiManagement.Gateway.Security.Protocols.Ssl30 <br>5. Microsoft.WindowsAzure.ApiManagement.Gateway.Security.Backend.Protocols.Tls10 <br>6. Microsoft.WindowsAzure.ApiManagement.Gateway.Security.Backend.Protocols.Tls11 <br>7. Microsoft.WindowsAzure.ApiManagement.Gateway.Security.Backend.Protocols.Ssl30 | <b>Scope: </b>This control applies to all variants of APIM service.<br><br><b>Config: </b> UnsecureProtocolsAndCiphersConfiguration: a. Protocols.Tls10,<br> b. Protocols.Tls11,<br> c. Protocols.Ssl30,<br> d. Backend.Protocols.Tls10,<br> e. Backend.Protocols.Tls11,<br> f. Backend.Protocols.Ssl30,<br> g. Ciphers.TripleDes168 <br><br><b>Passed: </b><br>All old versions of protocols and ciphers configurations are disabled.<br><br><b>Failed: </b><br>Old versions of protocols and ciphers configurations are being used.|
| <b>ControlId:</b><br>Azure_APIManagement_DP_Use_HTTPS_URL_Scheme<br><br><b>DisplayName:</b><br>Backend API(s) must be accessible only over HTTPS via API Management service. <br><br><b>Description: </b><br> Backend API(s) must be accessible only over HTTPS via API Management service. | <b>ARM API to list APIMs and its related property at Subscription level: </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.ApiManagement/service?api-version=2019-12-01</br><b>Properties:</b></br>isSecureProtocolUsed <br><br> | <b>Scope: </b> Applies to all variants of API Management service.<br><br><b>Config: </b>NA<br><br><b>Passed: </b><br> URL Scheme is set to 'https' for all APIs in API Management service.<br><br><b>Failed: </b><br>URL scheme is set to non-secure HTTP access for API Management service. <br><br><b>Verify: </b><br> Management API setting could not be verified as the API Management service is connected to a Virtual Network. As a result, control plane traffic on port 3443 is denied.|

<br>

<br> <b>

</b>


	






