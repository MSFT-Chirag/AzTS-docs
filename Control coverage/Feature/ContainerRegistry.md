## Container Registry

| ControlId | Dependent Azure API(s) and Properties | Control spec-let |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_ContainerRegistry_AuthZ_Disable_Admin_Account<br><br><b>DisplayName:</b><br>The Admin account in Container Registry should be disabled.<br><br><b>Description: </b><br> The Admin account in Container Registry should be disabled. | <b> ARM API to lists all the container registries under the specified subscription. </b> <br> /subscriptions/{subscriptionId}/providers<br>/Microsoft.ContainerRegistry/registries? <br> api-version=2019-05-01 <br><br><b>Properties:</b><br> properties.adminUserEnabled | <b>Scope: </b> Applies on all container registry resources.<br><br><b>Config: </b> NA<br><br> <b>Passed: </b><br> 'Admin User' is 'Disabled'. <br><br> <b>Failed: </b><br> 'Admin User' is 'Enabled'. |
| <b>ControlId:</b><br>Azure_ContainerRegistry_DP_Enable_Content_Trust<br><br><b>DisplayName:</b><br>Content trust must be enabled for the Container Registry.<br><br><b>Description: </b><br> Content trust must be enabled for the Container Registry. | <b> ARM API to lists all the container registries under the specified subscription. </b> <br> /subscriptions/{subscriptionId}/resourceGroups<br>/{resourceGroupName}/providers/Microsoft.ContainerRegistry<br>/registries/{ResourceName}/listPolicies<br>?api-version=2017-10-01 <br><br><b>Properties:</b><br> trustPolicy.status | <b>Scope: </b> Applies on all container registry resources.<br><br><b>Config: </b> NA<br><br> <b>Passed: </b><br> Content trust is enabled. <br><br> <b>Failed: </b><br> Content trust is not enabled. |
| <b>ControlId:</b><br>Azure_ContainerRegistry_Config_Enable_Security_Scanning<br><br><b>DisplayName:</b><br>Security scanner identity must be granted access to Container Registry for image scans.<br><br><b>Description: </b><br> Configure access for required identities to enable security scans of registry images. | <b> ARM API to list role assignment at scope: </b> <br> /{scope}/providers/Microsoft.Authorization/roleAssignments<br>?api-version=2018-01-01-preview <br><br><b>Properties:</b><br> UserName, RoleName, ResourceId | <b>Scope: </b> Applies on all container registry resources.<br><br><b>Config: </b> CentralAccount <br><br> <b>Passed: </b><br>1. No mandatory central account required. <br> *Or* <br>2. Mandatory central account found with required role. <br><br> <b>Failed: </b><br>Mandatory central account not found with required role. |


