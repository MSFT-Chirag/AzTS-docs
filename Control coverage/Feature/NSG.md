## NSG

| ControlId | Dependent Azure API(s) and Properties | Control spec |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_NSG_NetSec_Dont_Open_InBound_Any_Any<br><br><b>DisplayName:</b><br>Firewall/NSG rules must not allow unrestricted traffic (any-any rule).<br><br><b>Description: </b><br> Do not leave restricted ports open on Virtual Machines. |<b>ARM API to lists all the NSG configurations under<br> the specified subscription:</b> <br> /subscriptions/{subscriptionId}/providers<br>/Microsoft.Network/networkSecurityGroups<br>?api-version=2019-04-01 <br><br><b>Properties:</b><br> allowedInboundDestnPorts| <b>Scope: </b> All NSGs in subscription<br><br> <b>Config: </b> RestrictedPorts: 445,3389,5985,22<br><br><b>Passed: </b><br>Any-to-any inbound rule not found.<br><br><b>Failed: </b><br>Any-to-any inbound rule is found. <br><br>*Note: It wont check for the rule priority. It considers all the active inbound rules configured.*|
| <b>ControlId:</b><br>Azure_NSG_NetSec_Dont_Open_Restricted_Ports<br><br><b>DisplayName:</b><br>Risky ports for firewall/NSGs must not be allowed.<br><br><b>Description: </b><br> Do not leave restricted ports open on NSG. |<b> ARM API to lists all the NSG configurations under<br> the specified subscription:</b> <br> /subscriptions/{subscriptionId}/providers<br>/Microsoft.Network/networkSecurityGroups<br>?api-version=2019-04-01 <br><br><b>Properties:</b><br> portDetails| <b>Scope: </b> All NSGs in subscription.<br><br> <b>Config: </b> RestrictedPorts: 445,3389,5985,22<br><br><b>Passed: </b><br>1. If no restricted port [445,3389,5985,22] found. <br> *or* <br> 2. If Any-Any inbound rule not found.<br><br><b>Failed: </b><br>a. Any-to-any inbound rule found. <br> *or* <br> b. Restricted port(s) is found to be in the inbound rule range. <br><br>*Note: It wont check for the rule priority. It considers all the active inbound rules configured. This does not consider default inbound rule.*|


