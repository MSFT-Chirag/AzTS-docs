## Cloud Service

| ControlId | Dependent Azure API(s) and Properties | Control spec |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_CloudService_SI_Enable_AntiMalware<br><br><b>DisplayName:</b><br>Antimalware extension must be installed on cloud service roles. <br><br><b>Description: </b><br> Enable the Antimalware extension for the cloud service roles.| <b> ARM API to get Cloud Service extension details: </b> <br> /subscriptions/{subscriptionId}/resourceGroups<br>/{resourceGroupName}/providers/Microsoft.ClassicCompute<br>/domainNames/{cloudServiceName}/slots/{slotName}<br>/roles/{roleName}/extensionReferences? <br> api-version=2015-06-01  <br><br><b>Properties:</b><br> name: 'PaaSAntimalware-****', properties.state| <b>Scope: </b>Applies to all Azure Cloud Services. <br><br><b>Config: </b> NA<br><br> <b>Passed: </b><br> Antimalware extension is enabled for all the roles in this cloud service. <br><br><b>Failed: </b><br> Antimalware extension is not enabled for one or more roles in this cloud service. |
| <b>ControlId:</b><br>Azure_CloudService_DP_DontAllow_HTTP_Access_InputEndpoints<br><br><b>DisplayName:</b><br>Cloud service must encrypt data in transit. <br><br><b>Description: </b><br> Cloud Service must only be accessible over HTTPS. Enable https for InputEndpoints.| <b> ARM API to get Cloud Service extension details: </b> <br> /subscriptions/{subscriptionId}/resourceGroups<br>/{resourceGroupName}/providers/Microsoft.ClassicCompute<br>/domainNames/{cloudServiceName}/slots/{slotName}<br>/roles?api-version=2016-04-01  <br><br><b>Properties:</b><br> InputEndpoints| <b>Scope: </b>Applies to all variants of cloud service except deployment slots of type 'VirtualMachine'. <br><br><b>Config: </b> NA<br><br> <b>Passed: </b><br> No input endpoint in cloud service web/worker roles is using 'http' protocol. <br><br><b>Failed: </b><br>  Any input endpoint in cloud service web/worker roles is using 'http' protocol. |
| <b>ControlId:</b><br>Azure_CloudService_SI_Auto_OSUpdate<br><br><b>DisplayName:</b><br>OS version should be set to automatic. <br><br><b>Description: </b><br> OS version should be set to automatic.| <b> ARM API to get Cloud Service details: </b> <br> /subscriptions/{subscriptionId}/resourceGroups<br>/{resourceGroupName}/providers/Microsoft.ClassicCompute<br>/domainNames/{cloudServiceName}/slots<br>?api-version=2016-04-01  <br><br><b>Properties:</b><br> properties.configuration/Attribute/osVersion| <b>Scope: </b>Applies to all variants of cloud service except deployment slots of type 'VirtualMachine'. <br><br><b>Config: </b> NA<br><br> <b>Passed: </b><br> Cloud service is enabled with automatic OS updates for all slots. <br><br> <b>Failed: </b><br>  Cloud service is not set up for automatic OS updates. |
| <b>ControlId:</b><br>Azure_CloudService_SI_Disable_RemoteDesktop_Access<br><br><b>DisplayName:</b><br>Remote Desktop (RDP) access must be disabled on cloud service roles. <br><br><b>Description: </b><br> Remote Desktop (RDP) access must be disabled on cloud service roles.| <b> ARM API to get Cloud Service extension details: </b> <br> /subscriptions/{subscriptionId}/resourceGroups<br>/{resourceGroupName}/providers/Microsoft.ClassicCompute<br>/domainNames/{cloudServiceName}/slots/{slotName}<br>/roles/{roleName}/extensionReferences<br>?api-version=2015-06-01  <br><br><b>Properties:</b><br> name, properties.state, DeploymentSlot | <b>Scope: </b>Applies to all variants of Cloud Service. <br><br><b>Config: </b> NA<br><br> <b>Passed: </b><br> a. Remote desktop (RDP) extension is not enabled for cloud service role(s). <br>*or*<br> b. No role is present for cloud service.<br><br> <b>Failed: </b><br>  Remote desktop (RDP) extension is enabled for cloud service role(s). <br><br> <b>Verify: </b><br>Remote desktop (RDP) extension could not be verified for all the roles in cloud. |
