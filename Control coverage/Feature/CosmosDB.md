## Cloud Service

| ControlId | Dependent Azure API(s) and Properties | Control spec-let |
|-----------|-------------------------------------|------------------|
| <b>ControlId:</b><br>Azure_CosmosDB_AuthZ_Enable_Firewall<br><b>DisplayName:</b><br>Cosmos DB firewall should be enabled<br><b>Description: </b><br> Cosmos DB firewall should be enabled| <b> ARM API to get CosmosDB resources in a subscription  </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.DocumentDB/databaseAccounts?api-version=2019-08-01  <br><b>Properties:</b><br>properties.ipRangeFilter| <b>Passed: </b><br> Firewall IP range filter is set for CosmosDB. <br><b>Failed: </b><br> Firewall IP range filter is not set for CosmosDB. |
| <b>ControlId:</b><br>Azure_CosmosDB_AuthZ_Verify_IP_Range<br><b>DisplayName:</b><br>Configure only the required IP addresses on Cosmos DB firewall<br><b>Description: </b><br> Configure only the required IP addresses on Cosmos DB firewall| <b> ARM API to get CosmosDB resources in a subscription  </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.DocumentDB/databaseAccounts?api-version=2019-08-01  <br><b>Properties:</b><br> properties.ipRangeFilter| <b>Passed: </b><br> Firewall IP range filter is set for CosmosDB. <br><b>Failed: </b><br> Firewall IP range filter is not set for CosmosDB. |
| <b>ControlId:</b><br>Azure_CosmosDB_Deploy_Use_Automatic_Failover<br><b>DisplayName:</b><br>Use automatic failover<br><b>Description: </b><br>Use automatic failover<b>| ARM API to get CosmosDB resources in a subscription  </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.DocumentDB/databaseAccounts?api-version=2019-08-01 <br><b>Properties:</b><br>properties.enableAutomaticFailover| <b>Passed: </b><br> Automatic Failover is enabled for CosmosDB. <br><b>Failed: </b><br> Automatic Failover is not enabled for CosmosDB. |
| <b>ControlId:</b><br>Azure_CosmosDB_Deploy_Use_Replication<br><b>DisplayName:</b><br>Use global replication<br><b>Description: </b><br>Use global replication| <b> ARM API to get CosmosDB resources in a subscription  </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.DocumentDB/databaseAccounts?api-version=2019-08-01  <br><b>Properties:</b><br> properties.readLocations| <b>Passed: </b><br> Secondary read regions are set for CosmosDB. <br><b>Failed: </b><br> No Secondary read location is set for CosmosDB. |
| <b>ControlId:</b><br>Azure_CosmosDB_Enable_Adv_Threat_Protection<br><b>DisplayName:</b><br>Enable Threat detection for CosmosDB database<br><b>Description: </b><br> Threat Protection for Azure Cosmos DB provides an additional layer of security intelligence that detects unusual and potentially harmful attempts to access or exploit Azure Cosmos DB accounts.| <b> ARM API to get CosmosDB resources in a subscription  </b> <br> /subscriptions/{subscriptionId}/providers/Microsoft.DocumentDB/databaseAccounts?api-version=2019-08-01  <br><b>Properties:</b><br>properties.EnabledApiTypes<br><b>ARM API to get advanced threat protection settings</b><br> /{ResourceId}/providers/Microsoft.Security/advancedThreatProtectionSettings/current?api-version=2017-08-01-preview<br><b>Properties:</b><br> properties.isEnabled|<b>Passed: </b><br>  Advanced Threat Protection is enabled for CosmosDB. <br><b>Failed: </b><br> Advanced Threat Protection is not enabled for CosmosDB.<br><b>NotApplicable </b><br>Advanced Threat Protection is not available for the enabled API option(s) |	